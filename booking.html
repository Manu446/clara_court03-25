<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Booking – Clara Court Homes</title>
  <style>
    :root {
      --text: #0d0d0d;
      --muted: #5b5b5b;
      --accent: #1f2937;
      --bg: #ffffff;
      --card: #ffffff;
      --shadow: 0 10px 25px rgba(0,0,0,.08);
      --radius: 20px;
      --container: 1100px;
    }
    * { box-sizing: border-box; }
    body { margin:0; padding:0; background: var(--bg); color: var(--text); font-family: "Segoe UI", Roboto, Arial, sans-serif; line-height: 1.6; }
    h1,h2 { font-family: Georgia, 'Times New Roman', Times, serif; margin:0 0 .6rem; }
    h1 { font-size: clamp(2rem, 2.6rem + 1.2vw, 3rem); }
    h2 { font-size: 1.6rem; margin-bottom: 1rem; }
    p { color: var(--muted); margin:0 0 1rem; }

    .container { max-width: var(--container); margin: 0 auto; padding: 0 20px; }

    nav {
      position: fixed; top:0; left:0; width:100%; z-index:1000;
      background: rgba(17,24,39,0.7); backdrop-filter: blur(8px);
      box-shadow: var(--shadow); padding: 14px 0;
    }
    nav .container { display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .logo { display:flex; align-items:center; gap:10px; text-decoration:none; color:#fff; font-weight:700; font-size:1.1rem; }
    .logo img { height:40px; width:40px; border-radius:50%; object-fit:cover; }
    .nav-links { display:flex; gap:16px; flex-wrap:wrap; }
    .nav-links a { text-decoration:none; color:#fff; font-weight:600; transition:.2s; }
    .nav-links a:hover { color: var(--accent); }

    .hero {
      position: relative;
      min-height: 50vh;
      display: grid;
      place-items: center;
      text-align: center;
      color: #fff;
      margin-top: 72px;
    }
    .hero img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; filter: brightness(.55); }
    .hero .inner { position: relative; z-index: 2; padding: 0 15px; }
    .hero .inner p {  color: white; }

    .btn {
      display: inline-block; padding: 12px 22px; border-radius: 10px; background:#111827; color:#fff; text-decoration: none; font-weight:600;
      box-shadow: var(--shadow); cursor: pointer; border: none;
    }
    .btn:hover { transform: translateY(-1px); filter: brightness(1.05); }

    .booking { padding: 64px 0; }
    .form-card {
      background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow); padding: 32px;
      max-width: 600px; margin: auto;
    }
    .form-group { margin-bottom: 20px; }
    label { display:block; font-weight:600; margin-bottom: 6px; }
    input, select {
      width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; font-size: 1rem;
    }
    input:focus, select:focus {
      outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px rgba(31,41,55,.1);
    }
    #price-display, #total-display {
      margin-top: 8px;
      font-weight: 600;
      color: var(--accent);
    }
    footer { padding: 32px 0 56px; text-align:center; color: var(--muted); }
    @media (max-width: 600px) {
      h1 { font-size: 1.8rem; }
      .form-card { padding: 20px; }
      nav .container { flex-direction: column; gap:10px; }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in {
      animation: fadeIn 0.4s ease forwards;
    }

  </style>
</head>
<body>
  <nav>
    <div class="container">
      <a href="index.html" class="logo">
        <img src="pics/logo-removebg-preview.png" alt="Clara Court Logo">
        Clara Court
      </a>
      <div class="nav-links">
        <a href="index.html">Home</a>
        <a href="properties.html">Properties</a>
        <a href="booking.html">Book</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </nav>

  <section class="hero">
    <img src="pics/gz01.jpg" alt="Booking Hero" />
    <div class="inner container">
      <h1>Book Your Stay</h1>
      <p><em>Secure your furnished luxury holiday home in just a few clicks.</em></p>
    </div>
  </section>

  <section class="booking">
    <div class="container">
      <div class="form-card">
        <h2>Booking Details</h2>
        <div id="form-error" style="display:none; color: red; margin-bottom: 15px; font-weight: 600;"></div>
        <form id="bookingForm">
          <div class="form-group">
            <label for="property">Select Property</label>
            <select id="property" name="property" required>
              <option value="">-- Choose a property --</option>
              <option value="4500">Luxury Suite</option>
              <option value="3500">One Bedroom Apartment</option>
              <option value="2000">Studio Apartment</option>
            </select>
            <div id="price-display"></div>
          </div>

          <div class="form-group">
            <label for="rooms">Number of Rooms</label>
            <select id="rooms" name="rooms" required>
              <option value="">-- Select rooms --</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4+</option>
            </select>
          </div>

          <div class="form-group">
            <label for="checkin">Check-In Date</label>
            <input type="date" id="checkin" name="checkin" required />
          </div>

          <div class="form-group">
            <label for="checkout">Check-Out Date</label>
            <input type="date" id="checkout" name="checkout" required />
          </div>

          <div class="form-group">
            <label for="guests">Guests</label>
            <select id="guests" name="guests" required>
              <option value="">-- Select number of guests --</option>
              <option>1 Guest</option>
              <option>2 Guests</option>
              <option>3 Guests</option>
              <option>4+ Guests</option>
            </select>
          </div>

          <div id="total-display"></div>

          <div style="text-align:center; margin-top: 24px;">
            <button class="btn" type="submit">Confirm Booking</button>
          </div>
        </form>
      </div>
    </div>
  </section>

  <footer>© 2025 Clara Court Homes. All rights reserved.</footer>

  <script>
    const propertySelect = document.getElementById("property");
    const roomsSelect = document.getElementById("rooms");
    const checkinInput = document.getElementById("checkin");
    const checkoutInput = document.getElementById("checkout");
    const priceDisplay = document.getElementById("price-display");
    const totalDisplay = document.getElementById("total-display");
    const bookingForm = document.getElementById("bookingForm");

    // 1. Restrict to today and 6 months ahead
    const today = new Date();
    const sixMonthsLater = new Date();
    sixMonthsLater.setMonth(today.getMonth() + 6);

    const formatDate = (date) => date.toISOString().split("T")[0];

    checkinInput.min = formatDate(today);
    checkinInput.max = formatDate(sixMonthsLater);
    checkoutInput.min = formatDate(today);
    checkoutInput.max = formatDate(sixMonthsLater);
    
    // 2. Dynamic price calculation
    function calculateTotal() {
    const pricePerDay = parseInt(propertySelect.value) || 0;
    const rooms = parseInt(roomsSelect.value) || 0;
    const checkin = new Date(checkinInput.value);
    const checkout = new Date(checkoutInput.value);

      let days = 0;
      if (checkinInput.value && checkoutInput.value && checkout > checkin) {
        const diffTime = checkout - checkin;
        days = diffTime / (1000 * 60 * 60 * 24);
      }

      if (pricePerDay) {
        priceDisplay.textContent = `Price: Ksh ${pricePerDay} per day`;
      } else {
        priceDisplay.textContent = "";
      }

      if (pricePerDay && rooms && days > 0) {
        const total = pricePerDay * rooms * days;
        totalDisplay.textContent = `Total: Ksh ${total.toLocaleString()}`;
      } else {
        totalDisplay.textContent = "";
      }
    }

    propertySelect.addEventListener("change", calculateTotal);
    roomsSelect.addEventListener("change", calculateTotal);
    checkinInput.addEventListener("change", calculateTotal);
    checkoutInput.addEventListener("change", calculateTotal);
    
    // 3. Submit handler with visual validation
    bookingForm.addEventListener("submit", function (e) {
      e.preventDefault();

      const checkinDate = new Date(checkinInput.value);
      const checkoutDate = new Date(checkoutInput.value);
      const now = new Date();
      now.setHours(0, 0, 0, 0); // normalize time

      const errorMsg = document.getElementById("form-error");
      errorMsg.style.display = "none";
      
      if (checkinDate < now || checkoutDate < now) {
        showError("Dates must start from today.");
        return;
      }
      
      if (checkoutDate <= checkinDate) {
        showError("Check-out must be after check-in.");
        return;
      }
      
      // Save booking data
      const bookingData = {
        property: propertySelect.options[propertySelect.selectedIndex].text,
        pricePerDay: parseInt(propertySelect.value) || 0,
        rooms: roomsSelect.value,
        checkin: checkinInput.value,
        checkout: checkoutInput.value,
        guests: document.getElementById("guests").value,
        total: totalDisplay.textContent.replace("Total: Ksh ", "")
      };
      
      localStorage.setItem("bookingData", JSON.stringify(bookingData));
      window.location.href = "payment.html";
    });
    
    function showError(msg) {
      const errorMsg = document.getElementById("form-error");
      errorMsg.textContent = msg;
      errorMsg.style.display = "block";
      errorMsg.classList.add("fade-in");
    }
</script>
